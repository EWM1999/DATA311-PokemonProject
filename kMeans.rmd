---
title: "Kmeans"
author: "Barret Jackson"
date: "March 29, 2019"
output: pdf_document
---

Kmeans


```{r}
library(mclust)
library(cluster)
library(dplyr)
library(fpc)
pokemon<-read.csv("pokemon_alopez247.csv")
pokeNum<-select_if(pokemon, is.numeric)
distPoke<-daisy(pokemon)
#distPoke<-daisy(pokeNum)
summary(distPoke)
pokeDist<-cmdscale(distPoke)
plot(pokeDist, type = "n")
text(pokeDist, rownames(pokeDist))
set.seed(413)
#kAnimals<-kmeans(dAnimals, 3)
#plot(dAnimals, col = kAnimals$cluster)
#points(kAnimals$centers, col = 1:3, pch=8, cex=2)

clustore<-matrix(0, nrow = 721, ncol=25)
wsstore<-NULL
for(i in 1:10){
  km<-kmeans(pokeDist, i, nstart=10)
  clustore[,i]<-km$cluster
  wsstore[i]<-km$tot.withinss
}
plot(wsstore)

kPoke2<-kmeans(pokeDist, 7, nstart=25)
plot(pokeDist, col = kPoke2$cluster)
points(kPoke2$centers, col = 1:4, pch=8, cex=2)
#kAnimals$cluster
#table(rownames(pokemon), kPoke2$cluster)
out <- cbind(pokemon, clusterNum = kPoke2$cluster)
clusterGroups<-order(out$clusterNum, decreasing = TRUE)
out[clusterGroups,]

```

Ok, let's check out the mean for Total for each cluster

```{r}
for(i in 1:7) {
  print(paste("Mean for total for cluster ",i))
  print(mean(out[which(out$clusterNum==i),]$Total))
}
```

Ok, how about the number of isLegendary in each cluster

```{r}
for(i in 1:7) {
  print(paste("Number of isLegendary for cluster ",i))
  legendTemp<-out[which(out$clusterNum==i),]
  print(count(legendTemp,vars=isLegendary))
}
```

Ok, that didnt' look great, but it looks like isLegendary==TRUE are mostly in clusters 2 and 4.

Now I'll try to reduce the amount of clusters so that all of (or most of) the legendary Pokemon end up in one cluster

```{r}
pokeNum<-select_if(pokemon, is.numeric)
distPoke<-daisy(pokemon)
summary(distPoke)
pokeDist<-cmdscale(distPoke)
plot(pokeDist, type = "n")
text(pokeDist, rownames(pokeDist))
set.seed(413)
kPoke2<-kmeans(pokeDist, 6, nstart=25)
plot(pokeDist, col = kPoke2$cluster)
points(kPoke2$centers, col = 1:4, pch=8, cex=2)
out <- cbind(pokemon, clusterNum = kPoke2$cluster)
clusterGroups<-order(out$clusterNum, decreasing = TRUE)
out[clusterGroups,]
```

```{r}
for(i in 1:6) {
  legendTemp<-out[which(out$clusterNum==i),]
  print(count(legendTemp,vars=isLegendary))
}
```

Alright, we're gonna create a data frame with the means for each numeric value by cluster now

Ok fuck that, we'll create arrays for each variable and column bind them (stupid data frames...)

```{r}
tote <- rep(NA, 6)
hp <- rep(NA, 6)
att <- rep(NA, 6)
def <- rep(NA, 6)
spa <- rep(NA, 6)
spd <- rep(NA, 6)
spe <- rep(NA, 6)
hei <- rep(NA, 6)
wei <- rep(NA, 6)
cat <- rep(NA, 6)
prm <- rep(NA, 6)
leg <- c(0,0,0,0,0,46)
nlg <- c(157,169,127,103,112,7)
for(i in 1:6) {
  tote[i]<-mean(out[which(out$clusterNum==i),]$Total)
  hp[i]<-mean(out[which(out$clusterNum==i),]$HP)
  att[i]<-mean(out[which(out$clusterNum==i),]$Attack)
  def[i]<-mean(out[which(out$clusterNum==i),]$Defense)
  spa[i]<-mean(out[which(out$clusterNum==i),]$Sp_Atk)
  spd[i]<-mean(out[which(out$clusterNum==i),]$Sp_Def)
  spe[i]<-mean(out[which(out$clusterNum==i),]$Speed)
  hei[i]<-mean(out[which(out$clusterNum==i),]$Height_m)
  wei[i]<-mean(out[which(out$clusterNum==i),]$Weight_kg)
  cat[i]<-mean(out[which(out$clusterNum==i),]$Catch_Rate)
  prm[i]<-mean(na.omit(out[which(out$clusterNum==i),]$Pr_Male))
  # leg[i]<-mean(out[which(out$clusterNum==i),]$Total)
  # nlg[i]<-mean(out[which(out$clusterNum==i),]$Total)
}
pTab<-cbind(tote,hp,att,def,spa,spd,spe,hei,wei,cat,prm,leg,nlg)
```

```{r}
out[which(out$hasGender=="True"),]
na.omit(out)
```

```{r}
col<-c("Total","HP","Attack","Defense","Sp_Atk","Sp_Def","Speed","Height_m","Weight_kg","Catch_Rate","Pr_Male","Legend","!Legend")
row<-c("Clus1","Clus2","Clus3","Clus4","Clus5","Clus6")
colnames(pTab)<-col
rownames(pTab)<-row
pTab<-round(pTab,2)
pTab
```


```{r}
pokemon<-data.frame(pokemon)
linmod<-lm(Catch_Rate~Pr_Male,data=pokemon)
summary(linmod)
plot(pokemon$Pr_Male,pokemon$Catch_Rate)
abline(linmod)
```