---
title: "R Notebook"
output: html_notebook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#laurenedits

```{r}
data = read.csv("pokemon_alopez247.csv", header=T)
```

```{r}
library(nnet)
library(NeuralNetTools)
library(neuralnet)
set.seed(53747958)
numeric_col <- c(5:12, 16, 20:21)
pokemon[,numeric_col] <- scale(pokemon[,numeric_col])
trainset <- pokemon[1:505, ]
testset <- pokemon[506:721, ]
colnames(data)[22]<-"isLegendary"
nn <- neuralnet(isLegendary ~ Attack + Defense + HP + Sp_Atk + Sp_Def + Speed,data=trainset, hidden=4, linear.output=TRUE, threshold=0.01)
nn$result.matrix
plotnet(nn)
```

```{r}
results <- data.frame(actual = testset$isLegendary, prediction = nn.results$net.result)
results
```

```{r}
predval<- results[results$prediction.1>0.5,]
predval1<-vector()
for(i in predval[i,]) {
  predval1[i]<-as.logical(FALSE)
}
predval1

```

```{r}
predicted=results$prediction * abs(diff(range(isLegendary))) + min(isLegendary)
actual=results$actual * abs(diff(range(isLegendary))) + min(isLegendary)
comparison=data.frame(predicted,actual)
deviation=((actual-predicted)/actual)
comparison=data.frame(predicted,actual,deviation)
accuracy=1-abs(mean(deviation))
accuracy
```

